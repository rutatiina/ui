(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{l72z:function(t,e,s){"use strict";s.r(e);var a=s("o0o1"),i=s.n(a);function n(t,e,s,a,i,n,o){try{var l=t[n](o),r=l.value}catch(t){return void s(t)}l.done?e(r):Promise.resolve(r).then(a,i)}var o={components:{},data:function(){return{pageTitle:"Revenue Calculation",urlPost:"/crbt/revenue-calculations",pageAction:"Create",networks:[],taxes:[],deductions:[],attributes:{network_id:0,revenue_calculations:[]},revenueCalculationsBasedOn:[{value:"gross_revenue",text:"Gross Revenue"},{value:"balance",text:"Balance"}],revenueCalculationsType:[{value:"tax",text:"Tax"},{value:"deduction",text:"Deduction"}]}},mounted:function(){this.$root.appMenu("crbt"),this.attributes.network_id=this.$route.query.network_id,this.fetchAttributes()},watch:{$route:function(){this.fetchAttributes()}},methods:{attributesRowCreate:function(){this.attributes.revenue_calculations.push({type:"",based_on:"",tax_id:"",deduction_id:""})},attributesConfigRemove:function(t){this.$delete(this.attributes.configs,t),0===this.attributes.configs.length&&this.attributesRowCreate()},fetchAttributes:function(){var t,e=this;return(t=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.$root.loadingTxn=!0,t.next=4,axios.get(e.$route.fullPath,{params:{network_id:e.attributes.network_id}}).then((function(t){e.pageTitle=t.data.pageTitle,e.networks=t.data.networks,e.urlPost=t.data.urlPost,e.taxes=t.data.taxes,e.deductions=t.data.deductions,setTimeout((function(){e.attributes=t.data.attributes}),20),0===t.data.attributes.revenue_calculations.length&&e.attributesRowCreate()})).catch((function(t){console.log(t)})).finally((function(t){}));case 4:return t.abrupt("return",t.sent);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,s=arguments;return new Promise((function(a,i){var o=t.apply(e,s);function l(t){n(o,a,i,l,r,"next",t)}function r(t){n(o,a,i,l,r,"throw",t)}l(void 0)}))})()},formSubmit:function(t){t.preventDefault();var e=this;PNotify.removeAll();var s={title:!1,text:"Please wait as we do our thing",addclass:"bg-warning-400 border-warning-400",hide:!1,buttons:{closer:!1,sticker:!1}},a=new PNotify(s);axios.post(e.urlPost,this.attributes).then((function(t){s.text=t.data.messages.join("\n"),!0===t.data.status?(s.title="Success",s.type="success",s.addclass="bg-success-400 border-success-400",e.fetchAttributes()):(s.title="! Error",s.type="error",s.addclass="bg-warning-400 border-warning-400"),a.update(s),a.get().click((function(){a.remove()}))})).catch((function(t){e.response=t}))}},ready:function(){},beforeUpdate:function(){},updated:function(){},destroyed:function(){}},l=s("KHd+"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"page-header page-header-light"},[s("div",{staticClass:"page-header-content header-elements-md-inline"},[s("div",{staticClass:"page-title d-flex"},[s("h4",[s("i",{staticClass:"icon-file-plus2"}),t._v("\n                    "+t._s(t.pageTitle)+"\n                ")])])]),t._v(" "),s("div",{staticClass:"breadcrumb-line breadcrumb-line-light header-elements-md-inline"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"breadcrumb"},[s("a",{staticClass:"breadcrumb-item",attrs:{href:"/"}},[s("i",{staticClass:"icon-home2 mr-2"}),t._v(" "),s("span",{staticClass:"badge badge-primary badge-pill font-weight-bold rg-breadcrumb-item-tenant-name"},[t._v(" "+t._s(t._f("truncate")(this.$root.tenant.name,30))+" ")])]),t._v(" "),s("span",{staticClass:"breadcrumb-item"},[t._v("CRBT")]),t._v(" "),s("span",{staticClass:"breadcrumb-item"},[t._v("Revenue Calculations")]),t._v(" "),s("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.pageAction))])]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"header-elements"},[s("div",{staticClass:"breadcrumb justify-content-center"},[s("router-link",{staticClass:" btn btn-danger btn-sm rounded-round font-weight-bold",attrs:{to:"/crbt/revenue-calculations"}},[s("i",{staticClass:"icon-files-empty2 mr-1"}),t._v("\n                        Revenue Calculations\n                    ")])],1)])])]),t._v(" "),s("div",{staticClass:"content border-0 padding-0"},[s("div",{staticClass:"card shadow-none rounded-0 border-0"},[s("div",{staticClass:"card-body p-0"},[s("loading-animation"),t._v(" "),this.$root.loading?t._e():s("form",{staticClass:"max-width-1040",attrs:{method:"post",autocomplete:"off"},on:{submit:t.formSubmit}},[s("fieldset",[s("div",{staticClass:"form-group row"},[s("div",{staticClass:"offset-md-1 col-lg-11"},[s("div",{staticClass:"form-group row mr-0 ml-0"},[s("label",{staticClass:"col-auto col-form-label text-right bg-light border rounded-left border-right-0 font-weight-bold"},[t._v("\n                                        Network\n                                    ")]),t._v(" "),s("div",{staticClass:"col pl-0 pr-0"},[s("model-list-select",{staticClass:"rounded-left-0 rounded-right-0",attrs:{list:t.networks,"option-value":"id","option-text":"name",placeholder:"select network"},on:{input:t.fetchAttributes},model:{value:t.attributes.network_id,callback:function(e){t.$set(t.attributes,"network_id",e)},expression:"attributes.network_id"}})],1)])])]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._l(t.attributes.revenue_calculations,(function(e,a){return s("div",{staticClass:"form-group row"},[s("div",{staticClass:"offset-md-1 col-lg-3"},[s("div",{staticClass:"position-absolute",staticStyle:{left:"-25px"}},[s("span",{staticClass:"input-group-append border-0 rounded-0"},[s("button",{staticClass:"btn btn-outline bg-danger border-0 text-danger-800 btn-icon ",attrs:{type:"button",title:"Delete row"},on:{click:function(e){return t.attributesConfigRemove(a)}}},[s("i",{staticClass:"icon-cross3"})])])]),t._v(" "),s("div",[s("model-list-select",{staticClass:"form-control-sm",attrs:{list:t.revenueCalculationsBasedOn,"option-value":"value","option-text":"text",placeholder:"Select based on"},model:{value:e.based_on,callback:function(s){t.$set(e,"based_on",s)},expression:"revenue_calculation.based_on"}})],1)]),t._v(" "),s("div",{staticClass:"col-lg-3"},[s("model-list-select",{staticClass:"form-control-sm",attrs:{list:t.revenueCalculationsType,"option-value":"value","option-text":"text",placeholder:"select type"},model:{value:e.type,callback:function(s){t.$set(e,"type",s)},expression:"revenue_calculation.type"}})],1),t._v(" "),s("div",{staticClass:"col-lg-5"},["tax"==e.type||""==e.type?s("model-list-select",{staticClass:"form-control-sm",attrs:{list:t.taxes,"option-value":"id","option-text":"name",placeholder:"select tax"},model:{value:e.tax_id,callback:function(s){t.$set(e,"tax_id",s)},expression:"revenue_calculation.tax_id"}}):t._e(),t._v(" "),"deduction"==e.type?s("model-list-select",{staticClass:"form-control-sm",attrs:{list:t.deductions,"option-value":"id","option-text":"name",placeholder:"select deduction"},model:{value:e.deduction_id,callback:function(s){t.$set(e,"deduction_id",s)},expression:"revenue_calculation.deduction_id"}}):t._e()],1)])})),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"offset-md-1 col-lg-11"},[s("button",{staticClass:"btn btn-link pt-0 pb-0 pl-0 font-weight-bold",attrs:{type:"button"},on:{click:t.attributesRowCreate}},[s("i",{staticClass:"icon-plus2 mr-2"}),t._v(" Add Revenue Calculation configuration\n                                ")])])])],2),t._v(" "),s("div",{staticClass:"text-left col-md-10 offset-md-1 p-0"},[s("button",{staticClass:"btn btn-danger font-weight-bold",attrs:{type:"submit"}},[s("i",{staticClass:"icon-file-plus2 mr-1"}),t._v(" "+t._s(t.pageTitle)+"\n                        ")])])])],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"header-elements-toggle text-default d-md-none",attrs:{href:"#"}},[e("i",{staticClass:"icon-more"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row mt-4"},[e("h5",{staticClass:"offset-md-1 col-lg-11"},[this._v("Revenue Calculation configuration")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row mb-2"},[e("div",{staticClass:"offset-md-1 col-lg-3"},[e("span",{staticClass:"badge badge-primary font-weight-bold "},[this._v("Based on")])]),this._v(" "),e("div",{staticClass:"col-lg-3"},[e("span",{staticClass:"badge badge-primary font-weight-bold"},[this._v("Type (Tax/Deduction)")])]),this._v(" "),e("div",{staticClass:"col-lg-5"},[e("span",{staticClass:"badge badge-primary font-weight-bold"},[this._v("Tax / Deduction")])])])}],!1,null,null,null);e.default=r.exports}}]);