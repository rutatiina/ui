(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{XLOy:function(t,e,s){"use strict";var a=s("o0o1"),r=s.n(a);function i(t,e,s,a,r,i,o){try{var n=t[i](o),c=n.value}catch(t){return void s(t)}n.done?e(c):Promise.resolve(c).then(a,r)}e.a={mounted:function(){this.sourceUrls.items="/workshop/parts-and-accessories/vue-search-select-sales",this.sourceUrls.contacts="/workshop/contacts/search"},methods:{fetchPartsAndAccessories:function(t){var e,s=this;return(e=r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.txnItems[0].name="-initiate-"===t?"":t,t){e.next=3;break}return e.abrupt("return",!1);case 3:return a={search_text:t,search:[{column:"name",value:t}]},e.prev=4,e.next=7,axios.post("/workshop/parts-and-accessories/vue-search-select-sales",a).then((function(e){e.data[0].name="-initiate-"===t?"":t,s.txnItems=e.data})).catch((function(t){console.log(t)})).finally((function(t){}));case 7:return e.abrupt("return",e.sent);case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})),function(){var t=this,s=arguments;return new Promise((function(a,r){var o=e.apply(t,s);function n(t){i(o,a,r,n,c,"next",t)}function c(t){i(o,a,r,n,c,"throw",t)}n(void 0)}))})()}}}},mHB6:function(t,e,s){"use strict";s.r(e);var a=s("o0o1"),r=s.n(a);function i(t,e,s,a,r,i,o){try{var n=t[i](o),c=n.value}catch(t){return void s(t)}n.done?e(c):Promise.resolve(c).then(a,r)}var o={mixins:[s("XLOy").a],data:function(){return{pageTitle:"Job Inspection / Items",pageAction:"Update",urlStore:this.$route.fullPath,urlCreate:this.$route.fullPath,job:{}}},mounted:function(){this.fetchJobItems(),this.txnFetchContacts("-initiate-"),this.fetchPartsAndAccessories("-initiate-"),this.txnFetchTaxes()},methods:{fetchJobItems:function(){var t,e=this;return(t=r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,axios.get(e.urlCreate).then((function(t){e.pageTitle=t.data.pageTitle,e.pageAction=t.data.pageAction,e.txnAttributes.items=t.data.job.items,e.txnUrlStore=t.data.urlStore,e.job=t.data.job,e.txnTotal()})).catch((function(t){console.log(t)})).finally((function(t){}));case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})),function(){var e=this,s=arguments;return new Promise((function(a,r){var o=t.apply(e,s);function n(t){i(o,a,r,n,c,"next",t)}function c(t){i(o,a,r,n,c,"throw",t)}n(void 0)}))})()},formSubmit:function(t){t.preventDefault();var e=this;PNotify.removeAll();var s={title:!1,text:"Please wait as we do our thing",addclass:"bg-warning-400 border-warning-400",hide:!1,buttons:{closer:!1,sticker:!1}},a=new PNotify(s);axios.post(e.urlStore,this.txnAttributes).then((function(t){s.text=t.data.messages.join("\n"),!0===t.data.status?(s.title="Success",s.type="success",s.addclass="bg-success-400 border-success-400",e.attributes={name:"",code:"",country:""}):(s.title="! Error",s.type="error",s.addclass="bg-warning-400 border-warning-400"),a.update(s),a.get().click((function(){a.remove()}))})).catch((function(t){e.response=t}))}}},n=s("KHd+"),c=Object(n.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"page-header page-header-light"},[s("div",{staticClass:"page-header-content header-elements-md-inline"},[s("div",{staticClass:"page-title d-flex"},[s("h4",[s("i",{staticClass:"icon-file-plus"}),t._v("\n                    "+t._s(t.pageTitle)+"\n                ")])])]),t._v(" "),s("div",{staticClass:"breadcrumb-line breadcrumb-line-light header-elements-md-inline"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"breadcrumb"},[s("a",{staticClass:"breadcrumb-item",attrs:{href:"/"}},[s("i",{staticClass:"icon-home2 mr-2"}),t._v(" "),s("span",{staticClass:"badge badge-primary badge-pill font-weight-bold rg-breadcrumb-item-tenant-name"},[t._v(" "+t._s(t._f("truncate")(this.$root.tenant.name,30))+" ")])]),t._v(" "),s("span",{staticClass:"breadcrumb-item"},[t._v("Workshop")]),t._v(" "),s("span",{staticClass:"breadcrumb-item"},[t._v("Job")]),t._v(" "),s("span",{staticClass:"breadcrumb-item"},[t._v("Items")]),t._v(" "),s("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.pageAction))])]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"header-elements"},[s("div",{staticClass:"breadcrumb justify-content-center"},[s("router-link",{staticClass:" btn btn-danger btn-sm rounded-round font-weight-bold",attrs:{to:"/workshop/jobs/"+t.$route.params.id}},[s("i",{staticClass:"icon-drawer3 mr-2"}),t._v("\n                        Back to Job #"+t._s(t.$route.params.id)+"\n                    ")])],1)])])]),t._v(" "),s("div",{staticClass:"content border-0 padding-0"},[s("div",{staticClass:"card shadow-none rounded-0 border-0"},[s("div",{staticClass:"card-body p-0"},[s("loading-animation"),t._v(" "),this.$root.loading?t._e():s("form",{staticClass:"max-width-1040",staticStyle:{"margin-bottom":"100px"},attrs:{action:"",method:"post",autocomplete:"off"},on:{submit:t.formSubmit}},[s("div",{staticClass:"card p-0"},[s("div",{staticClass:"card-header bg-light d-flex justify-content-between"},[s("span",{staticClass:"font-size-sm text-uppercase font-weight-semibold"},[t._v("Job "),s("a",{attrs:{href:"#"}},[t._v("#"+t._s(t.job.id))])]),t._v(" "),s("span",{staticClass:"font-size-sm text-uppercase"},[t._v("\n                                Date: "),s("span",{staticClass:"font-weight-semibold"},[t._v(t._s(t.job.date))])])]),t._v(" "),s("div",{staticClass:"card-body"},[t.job.vehicle?s("div",{staticClass:"card-title"},[s("span",{staticClass:"h4 font-weight-semibold pr-3"},[t._v(t._s(t.job.vehicle.registration_number))]),t._v(" "),t.job.contact?s("span",[s("span",{staticClass:"badge badge-secondary badge-pill font-weight-semibold"},[t._v(" Customer ")]),t._v(" "),s("span",{staticClass:"h6"},[t._v(t._s(t.job.contact.display_name))])]):t._e()]):t._e(),t._v(" "),s("div",{staticClass:"card-text border-left-3 border-warning pl-2 pt-2 pb-2"},[t._m(1),t._v(" "),s("p",{staticClass:"mt-2",staticStyle:{"white-space":"pre"}},[t._v(t._s(t.job.description))])])]),t._v(" "),s("div",{staticClass:"card-footer d-flex justify-content-between"},[t.job.supervisor?s("span",{staticClass:"text-muted"},[t._v("Supervisor "+t._s(t.job.supervisor.display_name))]):t._e()])]),t._v(" "),s("div",{staticClass:"card border-0 shadow-0 p-0"},[s("div",{staticClass:"card-body p-0"},[s("table",{staticClass:"table table-bordered border-left-0 border-right-0 border-bottom-0"},[s("thead",{staticClass:"thead-default bg-light"},[s("tr",[s("th",{staticClass:"font-weight-bold",attrs:{width:"50%"}},[t._v("Service, Part, or Accessories")]),t._v(" "),s("th",{staticClass:"text-right font-weight-bold",attrs:{width:"8%"}},[t._v("Quantity")]),t._v(" "),s("th",{staticClass:"text-right font-weight-bold",attrs:{width:"11%"}},[t._v("Rate")]),t._v(" "),s("th",{staticClass:"font-weight-bold",attrs:{width:"13%"}},[t._v("Tax")]),t._v(" "),s("th",{staticClass:"text-right font-weight-bold p-0",attrs:{width:"18%"}},[s("div",{staticClass:"input-group"},[s("input",{staticClass:"rg-txn-item-row-total form-control border-0 text-right font-weight-bold bg-transparent",attrs:{type:"text",value:"Total",readonly:"",placeholder:"0.00"}}),t._v(" "),s("span",{staticClass:"input-group-append border-0 rounded-0"},[s("button",{staticClass:"btn bg-danger bg-transparent text-danger btn-icon",attrs:{type:"button",title:"Clear all items"},on:{click:t.txnItemsClearAll}},[s("i",{staticClass:"icon-cross3"})])])])])])]),t._v(" "),s("tbody",{attrs:{id:"items_field_rows"}},t._l(t.txnAttributes.items,(function(e,a){return s("tr",[s("td",{staticClass:"td_item_selector p-0 rg_select2_border_none"},[s("model-list-select",{staticClass:"border-0",attrs:{list:t.txnItems,"option-value":"id","option-text":"name","option-item-row":a,"option-tag":"",placeholder:"Select item"},on:{input:t.txnItemsSelect,searchchange:t.fetchPartsAndAccessories},model:{value:e.selectedItem,callback:function(s){t.$set(e,"selectedItem",s)},expression:"item.selectedItem"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.type_id||e.name,expression:"item.type_id || item.name"}],staticClass:"ml-2 mr-2"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"item.description"}],staticClass:"form-control mb-2",staticStyle:{"min-height":"30px",overflow:"hidden"},attrs:{"data-value":e.description,"data-row":a,rows:"1",onkeyup:"rgAutoGrow(this);",placeholder:"Description"},domProps:{value:e.description},on:{input:function(s){s.target.composing||t.$set(e,"description",s.target.value)}}})])],1),t._v(" "),s("td",{staticClass:"p-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"item.quantity"}],staticClass:"item_row_quantity form-control border-0 text-right",attrs:{type:"text","data-row":a,placeholder:"1"},domProps:{value:e.quantity},on:{keyup:t.txnTotal,input:function(s){s.target.composing||t.$set(e,"quantity",s.target.value)}}})]),t._v(" "),s("td",{staticClass:"p-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.rate,expression:"item.rate"}],staticClass:"item_row_rate form-control m-input border-0 text-right",attrs:{type:"text","data-row":a,placeholder:"0.00"},domProps:{value:e.rate},on:{keyup:t.txnTotal,input:function(s){s.target.composing||t.$set(e,"rate",s.target.value)}}})]),t._v(" "),s("td",{staticClass:"p-0"},[s("multi-list-select",{staticClass:"border-0",attrs:{list:t.txnTaxes,"option-value":"id","option-text":"display_name","option-item-row":a,"selected-items":e.selectedTaxes,placeholder:"select tax","show-count-of-selected-options":""},on:{select:t.txnItemTaxes}})],1),t._v(" "),s("td",{staticClass:"p-0"},[s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"input-group"},[s("input",{staticClass:"rg-txn-item-row-total form-control border-0 text-right bg-transparent",attrs:{type:"text",readonly:"",placeholder:"0.00"},domProps:{value:t.rgNumberFormat(e.displayTotal,2)}}),t._v(" "),s("span",{staticClass:"input-group-append border-0 rounded-0"},[s("button",{staticClass:"btn bg-danger bg-transparent text-danger btn-icon",attrs:{type:"button",title:"Delete row"},on:{click:function(e){return t.txnItemsRemove(a)}}},[s("i",{staticClass:"icon-cross3"})])])])])])])})),0),t._v(" "),s("tbody",[s("tr",[s("td",{staticClass:"border-0"},[s("button",{staticClass:"btn btn-link pt-0 pb-0 font-weight-bold",attrs:{type:"button"},on:{click:t.txnItemsCreate}},[s("i",{staticClass:"icon-plus2 mr-2"}),t._v(" Add another line\n                                        ")])]),t._v(" "),s("td",{staticClass:"pl-15 border-left-0 border-top-0 border-right-0 font-weight-bold",attrs:{colspan:"2"}},[t._v("Sub Total")]),t._v(" "),s("td",{staticClass:"border-left-0 border-top-0 border-right-0 text-right rg-txn-total-pr",attrs:{id:"txn_subtotal",colspan:"2"}},[t._v("\n                                        "+t._s(t.rgNumberFormat(t.txnAttributes.taxable_amount,2))+"\n                                    ")])])]),t._v(" "),s("tbody",{staticClass:"border-0"},t._l(t.txnAttributes.taxes,(function(e){return s("tr",[s("td",{staticClass:"p-15 border-0"}),t._v(" "),s("td",{staticClass:"p-15 border-left-0 border-top-0 border-right-0 font-weight-bold",attrs:{colspan:"2"}},[t._v(t._s(e.name))]),t._v(" "),s("td",{staticClass:"border-left-0 border-top-0 border-right-0 text-right pr-0",attrs:{colspan:"2"}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.total,expression:"tax.total"}],staticClass:"rg-txn-item-row-total form-control text-right",attrs:{type:"text",placeholder:"0.00"},domProps:{value:e.total},on:{input:function(s){s.target.composing||t.$set(e,"total",s.target.value)}}}),t._v(" "),s("span",{staticClass:"input-group-append border-0 rounded-0"},[s("button",{staticClass:"btn bg-danger bg-transparent text-danger btn-icon",attrs:{type:"button",title:"Remove Tax"},on:{click:function(s){return t.txnItemsTaxRemove(e.id)}}},[s("i",{staticClass:"icon-cross3"})])])])])])})),0),t._v(" "),s("tfoot",[s("tr",[s("td",{staticClass:"p-15 border-0"}),t._v(" "),s("td",{staticClass:"p-15 border-left-0 border-top-0 border-right-0 font-weight-bold size4of5",attrs:{colspan:"2"}},[t._v("\n                                        TOTAL\n                                        "),t.txnAttributes.base_currency?s("span",{staticClass:"badge badge-primary badge-pill font-weight-bold rg-breadcrumb-item-tenant-name"},[t._v("\n                                        "+t._s(t.txnAttributes.base_currency)+"\n                                    ")]):t._e()]),t._v(" "),s("td",{staticClass:"border-left-0 border-top-0 border-right-0 font-weight-bold size4of5 text-right rg-txn-total-pr",attrs:{id:"txn_total",colspan:"2"}},[t._v("\n                                        "+t._s(t.rgNumberFormat(t.txnAttributes.total,2))+"\n                                    ")])])])])])]),t._v(" "),t._m(2)])],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"header-elements-toggle text-default d-md-none",attrs:{href:"#"}},[e("i",{staticClass:"icon-more"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group text-left text-muted content-divider pl-3"},[e("span",{staticClass:"badge badge-flat border-grey-400 text-grey-300 font-weight-semibold"},[this._v(" Job description ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-left p-0"},[e("button",{staticClass:"btn btn-danger font-weight-bold",attrs:{type:"submit"}},[e("i",{staticClass:"icon-file-plus2 mr-1"}),this._v(" Update Job Items\n                        ")])])}],!1,null,null,null);e.default=c.exports}}]);