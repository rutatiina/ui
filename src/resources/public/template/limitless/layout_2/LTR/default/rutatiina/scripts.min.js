var rg_pnotify_options={initiate:{text:"Please wait as perform some magic ...",addclass:"bg-primary",type:"info",icon:"icon-spinner4 spinner",hide:false,buttons:{closer:true,sticker:false},opacity:0.9,width:"350px"},success:{buttons:{closer:true,sticker:true},width:"350px",title:"Done!",text:"",addclass:"bg-success",type:"success",icon:"icon-checkmark3",opacity:1,width:PNotify.prototype.options.width},error:{buttons:{closer:true,sticker:true},width:"350px",title:"Error(s)!",text:"",addclass:"bg-danger",type:"danger",icon:"icon-alert"}};var rutatiina=function(){var n=function(){console.log("Success: Load rutatiina > metronic js")};function m(t){return t}var l=function(){$("body").on("click","[data-href]",function(t){t.preventDefault();window.location.href=$(this).data("href")})};var j=function(u,t,w){var v=$('<div class="alert alert-'+t+' alert-dismissible fade show ml-4 mr-4 mt-4" role="alert">            <button type="button" class="close" data-dismiss="alert" aria-label="Close"></button>            <span></span>        </div>');u.find(".alert").remove();v.appendTo(u.find(".m-portlet__body"));v.animateClass("fadeIn animated");v.find("span").html(w)};var s=function(t,u){$.notify(u,{type:t,allow_dismiss:true,newest_on_top:true,timer:$("#m_notify_timer").val(),placement:{from:"top",align:"right"},offset:{x:30,y:30},delay:1000,z_index:10000,animate:{enter:"animated bounce",exit:"animated bounce"}})};var d=function(){$(".rg-select2-basic").select2();console.log("basic select2 inited")};var r=function(){$("#rg_select2_users").select2({ajax:{url:"/users/select2/",processResults:function(t){return{results:t}}},minimumInputLength:0,placeholder:"Choose user / client"});$("#rg_select2_asset").select2({ajax:{url:"/asset/select2/",processResults:function(t){return{results:t}}},minimumInputLength:0,placeholder:"Choose asset"});$("#rg_select2_asset_category").select2({ajax:{url:"/asset/category/select2/",processResults:function(t){return{results:t}}},minimumInputLength:0,placeholder:"Choose / enter asset category",tags:true})};var f=function(t){return t.serializeArray()};var b=function(t,w){w=typeof w!=="undefined"?w:true;console.log("Ajax processing form: "+t+", form_reset: "+w);var u=$(t);PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);var v=f(u);$.ajax({url:u.attr("action"),method:u.attr("method"),data:v,dataType:"json",success:function(z,x,A,y){if(z.status===true){rg_pnotify_options.success.text=z.message;rg_pnotify.update(rg_pnotify_options.success);if(w===true){u.trigger("reset");u.find(".select-search, .select").val("").trigger("change");if(t==="#item_form"){console.log("#item_type_"+v.type);u.find("#item_type_"+v.type).trigger("click")}}}else{rg_pnotify_options.error.text=z.message;rg_pnotify.update(rg_pnotify_options.error)}}})};var k=function(t,w){w=typeof w!=="undefined"?w:true;var u=$(t);PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);var v=f(u);$.ajax({url:u.attr("action"),method:u.attr("method"),data:v,dataType:"json",success:function(z,x,A,y){Ladda.stopAll();if(!rg_empty(z.result)){rg_pnotify_options.success.text=z.result;rg_pnotify.update(rg_pnotify_options.success);if(w===true){u.trigger("reset");u.find(".select-search, .select").val("").trigger("change")}}else{rg_pnotify_options.error.text=z.error;rg_pnotify.update(rg_pnotify_options.error)}}})};var c=function(){$(".hr_form_with_file").submit(function(x){var t=new FormData(this);var w=$(this);var v=w.attr("name");var u=$("#description").summernote("code");t.append("is_ajax",1);t.append("description",u);t.append("form",v);x.preventDefault();$(".save").prop("disabled",true);PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);$.ajax({url:x.target.action,type:"POST",data:t,contentType:false,cache:false,processData:false,success:function(y){Ladda.stopAll();if(y.error!=""){rg_pnotify_options.error.text=y.error;rg_pnotify.update(rg_pnotify_options.error);$(".save").prop("disabled",false);$(".icon-spinner3").hide()}else{rg_pnotify_options.success.text=y.result;rg_pnotify.update(rg_pnotify_options.success);xin_table.api().ajax.reload(function(){},true);$(".add-form").fadeOut("slow");$("#xin-form")[0].reset();$(".save").prop("disabled",false)}Ladda.stopAll()},error:function(){rg_pnotify_options.error.text=JSON.error;rg_pnotify.update(rg_pnotify_options.error);$(".icon-spinner3").hide();$(".save").prop("disabled",false)}})})};var p=function(t,w){w=typeof w!=="undefined"?w:true;console.log("Ajax processing form: "+t+", form_reset: "+w);var u=$(t);PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);var v=f(u);$.ajax({url:u.attr("action"),method:u.attr("method"),data:v,dataType:"json",success:function(z,x,A,y){if(z.status===true){rg_pnotify_options.success.text=z.message;rg_pnotify.update(rg_pnotify_options.success);var B='<tr>    <td class="col-lg-1 text-nowrap text-muted text-size-mini">'+z.data.created_on+'</td>    <td class="">        <span class="btn btn-icon btn-rounded border-green btn-xs text-green-600"><i class="icon-file-text2"></i></span>    </td>    <td class="col-lg-10">'+z.data.comment+"</td></tr>";$("#transaction_comments_table tbody").prepend(B);if(w===true){u.trigger("reset")}}else{rg_pnotify_options.error.text=z.message;rg_pnotify.update(rg_pnotify_options.error)}}})};var o=function(){$("#rg_modal_counterparty").on("shown.bs.modal",function(){$("#rg_select2_tags_modal").select2({tags:true})})};var q=function(){$(".rg_select2_basic").select2({})};var e=function(u){var t=$(u).parents(".rg-item-form");if($(u).val()=="product"){$("#track_inventory").show()}else{$("#track_inventory").hide()}if(u.checked){t.find("#item_rates").removeClass("service_rates");t.find("#item_rates").removeClass("cost_center_rates");var v=$(u).val();if(v=="cost_center"){t.find("#item_rates").addClass("cost_center_rates")}else{if(v=="service"){t.find("#item_rates").addClass("service_rates")}}}};var h=function(t){var u=$.extend({url:"/missing-url-parameter/",ids:[],onSuccessCallback:function(){},onFailureCallback:function(){},title:"Are you sure?",text:"You will not be able to recover this Invoice(s)!",type:"warning",showCancelButton:true,confirmButtonColor:"#EF5350",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel pls!",closeOnConfirm:false,closeOnCancel:true,showLoaderOnConfirm:true},t);swal({title:u.title,text:u.text,type:u.type,showCancelButton:u.showCancelButton,confirmButtonColor:u.confirmButtonColor,confirmButtonText:u.confirmButtonText,cancelButtonText:u.cancelButtonText,closeOnConfirm:u.closeOnConfirm,closeOnCancel:u.closeOnCancel,showLoaderOnConfirm:u.showLoaderOnConfirm},function(v){if(v){$.ajax({url:u.url,method:"POST",data:{ids:u.ids},dataType:"json",success:function(y,w,z,x){if(y.status===true){swal({title:"Deleted!",text:y.message,confirmButtonColor:"#66BB6A",type:"success",timer:2000});$(".rg_datatable_onselect_btns").slideUp(100);u.onSuccessCallback(u.datatable)}else{swal({title:"Failed!",text:y.message,confirmButtonColor:"#66BB6A",type:"error",timer:2000});u.onFailureCallback()}}})}});return true};var g=function(x){var v=$("#contact_person_field_rows tr");var w=v.length;var u=w-1;if(w>1&&x===false){v.not(".contact_person_row_template").find("select").select2({minimumResultsForSearch:Infinity});return true}var t=$(".contact_person_row_template").clone();t.removeClass("contact_person_row_template hidden");t.attr("id","row_"+u);t.find("[name^=contact_person]").each(function(){var y=$(this).attr("name");$(this).attr("name",y.replace("_index_",u));$(this).attr("data-row",u)});t.appendTo("#contact_person_field_rows");t.find("select").select2({minimumResultsForSearch:Infinity})};var a=function(u){var t="";$("body").delegate(".import_btn","click",function(){t=$(this).data("import");console.log($(this).data("import"))});Dropzone.options.rgDropzone={uploadMultiple:false,parallelUploads:5,paramName:"file",maxFiles:1,maxFilesize:5,dictDefaultMessage:"Drop files to upload <span>or CLICK</span>",clickable:".import_btn",createImageThumbnails:false,init:function(){var v=this;v.on("addedfile",function(w){setTimeout(function(){},10)});v.on("sending",function(w,y,x){x.append("import",t)});v.on("processing",function(w){v.options.url="/import/"});v.on("success",function(x,w){v.removeAllFiles();var w=JSON.parse(w);PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);if(w.status===true){rg_pnotify_options.success.text=w.message;rg_pnotify.update(rg_pnotify_options.success)}else{rg_pnotify_options.error.text=w.message;rg_pnotify.update(rg_pnotify_options.error)}})}}};var i=function(){var t=$("body");t.on("click",".btn-update-text ul li a",function(){var u=$(this);u.parents(".btn-update-text").find(".btn-text").html(u.data("text"))});t.on("click",".rg_ajax_call",function(u){var v=$(this);u.preventDefault();console.log("Ajax call to: "+v.attr("href"));PNotify.removeAll();rg_pnotify=new PNotify(rg_pnotify_options.initiate);$.ajax({url:v.attr("href"),method:"POST",dataType:"json",success:function(y,w,z,x){if(y.status===true){rg_pnotify_options.success.text=y.message;rg_pnotify.update(rg_pnotify_options.success)}else{rg_pnotify_options.error.text=y.message;rg_pnotify.update(rg_pnotify_options.error)}if(!rg_empty(y.redirect)){window.location.replace(y.redirect)}}})});t.on("click","#transaction_comment_add_link, #transaction_comment_form_cancel",function(u){u.stopPropagation();u.preventDefault();$("#transaction_comment_form_tr, #transaction_comment_add_link").toggleClass("hidden")})};return{init:function(){i();l();n();q();o();c();a()},showResponse:function(u,t,v){j(u,t,v)},testFunction:function(){n()},js_ucfirst:function(t){m(t)},notifyResponse:function(t,u){s(t,u)},select2BasicInit:function(){d()},select2FieldInit:function(){r()},form_ajax_submit:function(t){b(t)},hr_form_ajax_submit:function(t){k(t)},txn_comment_form_ajax_submit:function(t){p(t)},item_type_change:function(t){e(t)},transaction_delete:function(t){h(t)},new_contact_person:function(t){g(t)}}}();jQuery(document).ready(function(){rutatiina.init();rutatiina.new_contact_person(false)});