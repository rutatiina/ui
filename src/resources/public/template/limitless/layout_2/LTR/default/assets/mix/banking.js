!function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=5)}({"1ohs":function(t,e){function a(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var n,o,i,s;rg_banking=(n=function(t){var e=$.extend({url:APP_URL+"/empty-response",ajax_data:[],onSuccessCallback:function(){},onFailureCallback:function(){},title:"Are you sure?",text:"You will not be able to recover this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#EF5350",confirmButtonText:"Yes, proceed",cancelButtonText:"No, cancel pls!",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},t);return swal({title:e.title,text:e.text,type:e.type,showCancelButton:e.showCancelButton,confirmButtonColor:e.confirmButtonColor,confirmButtonText:e.confirmButtonText,cancelButtonText:e.cancelButtonText,closeOnConfirm:e.closeOnConfirm,closeOnCancel:e.closeOnCancel,showLoaderOnConfirm:e.showLoaderOnConfirm},(function(t){t&&$.ajax({url:e.url,method:"POST",data:e.ajax_data,dataType:"json",success:function(t,a,n,o){!0===t.status?(swal({title:"Excluded!",text:t.message,confirmButtonColor:"#66BB6A",type:"success",timer:2e3}),$(".rg_datatable_onselect_btns").slideUp(100),e.onSuccessCallback(e.datatable)):(swal({title:"Failed!",text:t.message,confirmButtonColor:"#66BB6A",type:"error",timer:2e3}),e.onFailureCallback())}})})),!0},o=function(){var t=$("#transaction_rule_criteria_fields"),e=$(".transaction_rule_criteria_fields").length,a=t.clone();a.removeAttr("id"),a.removeClass("hidden"),a.attr("data-key","row_"+e),a.find("select, input").each((function(){var t=$(this).attr("name");$(this).attr("name",t.replace("[_]","["+e+"]"))})),$("#transaction_rule_criteria_add").before(a),a.find("select").select2({})},i=function(){var t=$(".account_balance");$.ajax({url:"/banking/balance/"+t.data("account_id")+"/",method:"POST",dataType:"json",success:function(e,a,n,o){!0===e.status?t.html(e.message):(PNotify.removeAll(),rg_pnotify=new PNotify(rg_pnotify_options.initiate),rg_pnotify_options.error.text=e.message,rg_pnotify.update(rg_pnotify_options.error))}})},s=function(){var t=$("body");$(".bank_transaction li a").click((function(t){t.preventDefault(),$(".tabbable [id^=tabs_]").addClass("hidden"),$(".tabbable #tabs_add_transaction").removeClass("hidden"),$(".sidebar-opposite").removeClass("hidden"),$(".sidebar-opposite .txn_form_panel").addClass("hidden"),$($(this).data("panel")).removeClass("hidden"),$($(this).data("panel")).find(".panel-heading").removeClass("hidden"),$($(this).data("panel")).find("form").trigger("reset"),$(".transactions_tax_form_fields").removeClass("hidden"),$("#banking_category_money_out, #banking_category_money_in").addClass("hidden"),$(".banking_item_rate").removeClass("text-danger").prop("readonly",!1),$("[name=_transaction_id]").val(""),$("[name=_transaction_status]").val("")})),$("[name=banking_category_money_out], [name=banking_category_money_in]").change((function(){$(".txn_form_panel:not(.txn_category_panel)").addClass("hidden"),$($(this).val()).removeClass("hidden"),$($(this).val()).find(".panel-heading").addClass("hidden")})),$(".hide-sidebar-opposite").click((function(){$(".sidebar-opposite").addClass("hidden"),$(".sidebar-opposite .txn_form_panel").addClass("hidden")})),$(".import_from_desktop").click((function(){console.log("Choose file to import"),$("#file_to_import").click()})),$("#transaction_rule_form [name=apply_to]").click((function(){var t=$(this);$("#transaction_rule_deposit_process_as_row, #transaction_rule_withdraw_process_as_row").addClass("hidden"),t.is(":checked")&&$("#transaction_rule_"+t.val()+"_process_as_row").removeClass("hidden")})),$("#file_to_import").change((function(){var t=$(this).val();t=t.replace(/.*[\/\\]/,""),$("#file_to_import_name").html(t)})),t.delegate("#transaction_rule_deposit_process_as_field, #transaction_rule_withdraw_process_as_field","change",(function(){var t=$(this).val();$("._options").addClass("hidden"),rg_empty(t)?$("._options").addClass("hidden"):$("#"+t+"_fields").toggleClass("hidden")})),t.delegate("#transaction_rule_criteria_add a","click",(function(){o()})),t.on("mouseenter",".banking_transactions_possible_matches button",(function(){$(this).removeClass("btn-default").addClass("btn-success text-semibold")})),t.on("mouseleave",".banking_transactions_possible_matches button",(function(){$(this).removeClass("btn-success text-semibold").addClass("btn-default")})),$(".dropdown .dropdown-menu").on("click","li a",(function(){$(this).parents(".dropdown").find(".dropdown-title").html($(this).html()).data("ajax",$(this).data("ajax"))})),t.on("click","button.banking_transaction_match",(function(){var t=$(this);PNotify.removeAll(),rg_pnotify=new PNotify(rg_pnotify_options.initiate),$.ajax({url:"/banking/transactions/"+t.data("account_id")+"/match/",method:"POST",data:{_financial_account_code:t.data("account_id"),_bank_transaction_id:t.data("bank_transaction"),_transaction_id:t.data("transaction")},dataType:"json",success:function(t,e,a,n){!0===t.status?(rg_pnotify_options.success.text=t.message,rg_pnotify.update(rg_pnotify_options.success),$("#transaction_matches tbody").html(""),$(".hide-sidebar-opposite").trigger("click"),$(".dropdown-title:first").trigger("click")):(rg_pnotify_options.error.text=t.message,rg_pnotify.update(rg_pnotify_options.error))}})})),t.on("change keyup","[name=_tax_id], .banking_item_rate, ._bank_charge_field, ._tax_base_field",(function(){var t=$(this).parents("form"),e=function(t,e,a){if(void 0===e)return 0;if("%"===(e=e.toString()).substr(-1,1)){var n=e.substr(0,e.length-1);return isNaN(n)?0:"inclusive"===a?t-t/(1+rg_number(n)/100):t*(rg_number(n)/100)}return rg_number(e)}(t.find("._tax_base_field").is(":checked")?t.find("._bank_charge_field").val():t.find(".banking_item_rate").val(),t.find("[name=_tax_id]").find(":selected").data("value"),t.find("[name=_tax_id]").find(":selected").data("method"));e>0?t.find("[name=_tax_amount]").val(rg_number_format(e,rg_decimal_places,".","")):t.find("[name=_tax_amount]").val("")})),t.on("click",".rg_ajax_bank_account_destroy",(function(t){var e=$(this);t.stopPropagation(),t.preventDefault(),method=void 0!==e.data("method")?e.data("method"):"POST",_method=void 0!==e.data("_method")?e.data("_method"):"POST",rutatiina.transaction_delete({datatable:null,url:e.attr("href"),method:method,data:{_method:_method},onSuccessCallback:function(t){},onFailureCallback:function(){},title:"Are you sure?",text:"You will not be able to recover this Bank Account!",type:"warning",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel pls!"})}))},{init:function(){s(),o();try{$(".rg_datatable_reconcile").DataTable({pagingType:"simple",serverSide:!0,fixedHeader:!0,ajax:APP_URL+"/datatable/banking_reconciliations/",language:{paginate:{next:"Next &rarr;",previous:"&larr; Prev"}},iDisplayLength:50,aLengthMenu:[[10,20,50,100,150,200,250,300,350,400],[10,20,50,100,150,200,250,300,350,400]],columnDefs:[{targets:0,orderable:!0,checkboxes:{selectRow:!0,selectCallback:function(t,e,a){t.column(0).checkboxes.selected().length}}}],select:{style:"multi",selector:"td:first-child"},aaSorting:[[0,"asc"]],order:[[0,"asc"]],ordering:!0,info:!0,bLengthChange:!0,aoColumns:[{mDataProp:"id",sClass:""},{mDataProp:null,sClass:""},{mDataProp:"date",sClass:""},{mDataProp:"value_date",sClass:""},{mDataProp:"description",sClass:""},{mDataProp:"reference",sClass:""},{mDataProp:"debit",sClass:"text-right"},{mDataProp:"credit",sClass:"text-right"},{mDataProp:"balance",sClass:"text-right"}],fnRowCallback:function(t,e,a,n){$("td:eq(1)",t).html('<ul class="icons-list"><li><a href="#/'+e.id+'" class="accouting_add" title="Add transaction"><i class="icon-file-plus"></i></a></li><li><a href="#/'+e.id+'" title="Search for transaction"><i class="icon-search4"></i></a></li><li><a href="#/'+e.id+'" title="Re-auto reconsile"><i class="icon-loop3"></i></a></li></ul> '),e._debit=e.debit>0?rg_number_format(e.debit,rg_decimal_places)+" "+e.currency:" - ",e._credit=e.credit>0?rg_number_format(e.credit,rg_decimal_places)+" "+e.currency:" - ",e._balance=e.balance>0?rg_number_format(e.balance,rg_decimal_places)+" "+e.currency:" - ",$("td:eq(6)",t).html(e._debit),$("td:eq(7)",t).html(e._credit),$("td:eq(8)",t).html(e._balance)}}),$("body").delegate(".accouting_add","click",(function(){$("#modal_accouting_add").modal()}))}catch(t){console.log(t)}try{!function(){var t=$(".rg_datatable_transactions").DataTable({pagingType:"simple",processing:!0,serverSide:!0,fixedHeader:!0,ajax:APP_URL+"/datatable/empty/",deferLoading:0,language:{paginate:{next:"Next &rarr;",previous:"&larr; Prev"}},iDisplayLength:25,aLengthMenu:[[10,20,50,100,150,200,250,300,350,400],[10,20,50,100,150,200,250,300,350,400]],columnDefs:[{targets:0,orderable:!1,checkboxes:{selectRow:!0,selectCallback:function(t,e,a){var n=t.column(0).checkboxes.selected().length;$("#number_of_selected_transactions").html(n),n>0?($("#transactions_nav_exclude").removeClass("hidden"),$("#transactions_nav").addClass("hidden")):($("#transactions_nav_exclude").addClass("hidden"),$("#transactions_nav").removeClass("hidden"))}}}],select:{style:"multi",selector:"td:first-child"},aaSorting:[[0,"asc"]],ordering:!1,info:!0,bLengthChange:!0,aoColumns:[{mDataProp:"id",sClass:""},{mDataProp:"date",sClass:"pointer"},{mDataProp:"description",sClass:"pointer"},{mDataProp:"reference",sClass:"pointer"},{mDataProp:"status",sClass:"pointer"},{mDataProp:null,sClass:"pointer text-right"},{mDataProp:null,sClass:"pointer text-right"}],fnRowCallback:function(t,e,a,n){e._debit=e.debit_amount>0?rg_number_format(e.debit_amount,rg_decimal_places)+" "+e.currency:" - ",e._credit=e.credit_amount>0?rg_number_format(e.credit_amount,rg_decimal_places)+" "+e.currency:" - ",$("td:eq(5)",t).html(e._debit),$("td:eq(6)",t).html(e._credit),$("td:gt(0)",t).click((function(){if($(".categorize_manually").removeClass("categorize_manually"),!rg_empty(e.status))return $(".hide-sidebar-opposite").trigger("click"),$(".txn_form_panel form").trigger("reset"),$("[name=_transaction_id]").val(""),$("[name=_transaction_status]").val(""),!1;$("#transaction_matches tbody").html(""),$.ajax({url:"/banking/transactions/"+e.account_id+"/matches/",method:"POST",data:{_transaction_id:e.id},dataType:"json",success:function(t,a,n,o){$("#transaction_matches tbody").html("");var i="";$.each(t.transactions,(function(t,a){i+='<tr class="banking_transactions_possible_matches">',i+="<td>",i+="<p>"+a.txn_type.name+" for "+a.base_currency+' <span class="text-semibold">'+rg_number_format(a.total,rg_decimal_places)+"</span></p>",i+="<span>Date: "+a.date+"</span>",i+="</td>",i+='<td class="text-right">',i+='<button type="button" class="btn btn-default banking_transaction_match" data-account_id="'+e.account_id+'" data-bank_transaction="'+e.id+'" data-transaction="'+a.id+'"> Match </button>',i+="</td>",i+="</tr>"})),$("#transaction_matches tbody").html(i)}}),$(t).find("td").addClass("categorize_manually"),$(".tabbable [id^=tabs_]").addClass("hidden"),$(".tabbable #tabs_selected_transaction").removeClass("hidden"),$(".sidebar-opposite").removeClass("hidden"),$(".sidebar-opposite .txn_form_panel").addClass("hidden"),$(".transactions_tax_form_fields").addClass("hidden");var a=0;e.credit_amount>0&&(a=e.credit_amount,$("#banking_expense, #banking_category_money_out").removeClass("hidden"),$("#banking_expense .panel-heading").addClass("hidden"),$("[name=banking_category_money_out]").val("#banking_expense").trigger("change")),e.debit_amount>0&&(a=e.debit_amount,$("#banking_other_deposit, #banking_category_money_in").removeClass("hidden"),$("#banking_other_deposit .panel-heading").addClass("hidden"),$("[name=banking_category_money_in]").val("#banking_other_deposit").trigger("change")),$("[name=_transaction_id]").val(e.id),$("[name=_transaction_status]").val("Categorized"),$("[name=date]").val(e.date),$("[name=reference]").val(e.reference),$(".banking_item_rate").val(a).addClass("text-danger").prop("readonly",!0),$(".banking_item_description").val(e.description)}))}});$("body").delegate(".accouting_add","click",(function(){$("#modal_accouting_add").modal()})),$("body").delegate(".banking_txn_sorting","click",(function(){console.log("re drawing the table");var e=$(this).data("ajax");t.ajax.url(e).load()})),$("#transactions-btn-exclude").click((function(){var e=[],a=$(this).data("url"),o=$(this).data("financial-account-code"),i=t.column(0).checkboxes.selected();try{$.each(i,(function(t,a){e[t]=a}))}catch(t){}n({datatable:t,url:a,ajax_data:{ids:e,columns:{status:"Excluded"},account_id:o,_method:"POST"},onSuccessCallback:function(t){t.ajax.reload(),$(".rg_datatable_onselect_btns").slideUp(100)},onFailureCallback:function(){},title:"Are you sure?",text:"You want to exclude selected transactions(s)!",type:"warning",confirmButtonText:"Yes, proceed",cancelButtonText:"No, cancel!"})})),$("#transactions-btn-delete").click((function(){var e=[],a=$(this).data("url"),o=$(this).data("financial-account-code"),i=t.column(0).checkboxes.selected();try{$.each(i,(function(t,a){e[t]=a}))}catch(t){}n({datatable:t,url:a,ajax_data:{ids:e,account_id:o,_method:"DELETE"},onSuccessCallback:function(t){t.ajax.reload(),$(".rg_datatable_onselect_btns").slideUp(100)},onFailureCallback:function(){},title:"Are you sure?",text:"Delete selected transactions(s) from Que!",type:"warning",confirmButtonText:"Yes, proceed",cancelButtonText:"No, cancel!"})}))}()}catch(t){console.log(t)}try{!function(){var t,e=$(".rg_datatable").DataTable((a(t={buttons:{dom:{button:{className:"btn btn-default"}},buttons:[{extend:"copyHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-copy3"></i>'},{extend:"excelHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-file-excel"></i>'},{extend:"pdfHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-file-pdf"></i>'}]},ajax:APP_URL+"/datatable/bank_accounts/",pagingType:"simple",language:{paginate:{next:"Next &rarr;",previous:"&larr; Prev"}},iDisplayLength:20,aLengthMenu:[[10,20,50,100],[10,20,50,100]],columnDefs:[{targets:0,orderable:!1,checkboxes:{selectRow:!0,selectCallback:function(t,e,a){t.column(0).checkboxes.selected().length>0?$(".rg_datatable_onselect_btns").slideDown(100):$(".rg_datatable_onselect_btns").slideUp(100)}}},{targets:[0,4,5,6],orderable:!1}],select:{style:"multi",selector:"td:first-child"},order:[[0,!1]],ordering:!1},"iDisplayLength",20),a(t,"aoColumns",[{mDataProp:"id"},{mDataProp:null,sClass:"text-center"},{mDataProp:"bank",sClass:""},{mDataProp:"name",sClass:""},{mDataProp:"number",sClass:""},{mDataProp:"code",sClass:"text-left"},{mDataProp:"currency",sClass:"text-left"},{mDataProp:"balance",sClass:"text-right"}]),a(t,"fnRowCallback",(function(t,e,a,n){var o='<ul class="icons-list">                    <li><a href="/banking/account/'+e.id+'" title="Edit"><i class="icon-pencil7"></i></a></li>                 </ul>';$("td:eq(1)",t).html(o)})),t));$(".navbar-fixed-top").on("click",".rg_datatable_selected_delete, .rg_datatable_row_delete",(function(t){t.stopPropagation(),t.preventDefault();var a=[],n=rg_empty($(this).data("url"))?$(this).attr("href"):$(this).data("url"),o=e.column(0).checkboxes.selected();try{$.each(o,(function(t,e){a[t]=e}))}catch(t){}rutatiina.transaction_delete({datatable:e,url:n,data:{ids:a},onSuccessCallback:function(t){t.ajax.reload(),$(".rg_datatable_onselect_btns").slideUp(100)},onFailureCallback:function(){},title:"Are you sure?",text:"You will not be able to recover this Invoice(s)!",type:"warning",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel pls!"})}))}()}catch(t){console.log(t)}try{$("#rg_datatable_banking_transaction_rules").DataTable({pagingType:"simple",serverSide:!0,fixedHeader:!0,language:{paginate:{next:"Next &rarr;",previous:"&larr; Prev"}},iDisplayLength:25,aLengthMenu:[[10,20,50,100,150,200,250,300,350,400],[10,20,50,100,150,200,250,300,350,400]],columnDefs:[{targets:0,orderable:!1,checkboxes:{selectRow:!0,selectCallback:function(t,e,a){t.column(0).checkboxes.selected().length}}}],select:{style:"multi",selector:"td:first-child"},aaSorting:[[0,"asc"]],ordering:!1,info:!0,bLengthChange:!0,aoColumns:[{mDataProp:"id",sClass:""},{mDataProp:"name",sClass:""},{mDataProp:"apply_to",sClass:""},{mDataProp:"process_as",sClass:""},{mDataProp:"criteria",sClass:""}],fnRowCallback:function(t,e,a,n){$("td:eq(1)",t).html('<a href="#">'+e.name+"</a>");var o="";$.each(e.criteria,(function(t,e){o+="<div>",o+='<span class="label label-default">'+e.column+"</span> ",o+='<span class="label label-default">'+e.condition+"</span> ",o+='<span class="text-uppercase">'+e.value+"</span> ",o+="</div>"}));var i="";i+="<div>",$.each(e.options,(function(t,e){i+='<span class="label label-primary">'+t+": "+e+"</span> "})),i+="</div>",$("td:eq(4)",t).html(o+i)}})}catch(t){console.log(t)}},form_ajax_submit:function(t,e){!function(t,e){e=void 0===e||e,console.log("Ajax processing form: "+t+", form_reset: "+e);var a=$(t);PNotify.removeAll(),rg_pnotify=new PNotify(rg_pnotify_options.initiate);var n=a.serializeArray();$.ajax({url:a.attr("action"),method:a.attr("method"),data:n,dataType:"json",success:function(t,n,o,s){!0===t.status?(rg_pnotify_options.success.text=t.message,rg_pnotify.update(rg_pnotify_options.success),$(".dropdown-title:first").trigger("click"),i(),!0===e&&($("[name=_transaction_id]").val(""),a.trigger("reset"),a.find(".select-search, .select").val("").trigger("change"),$(".hide-sidebar-opposite").trigger("click"))):(rg_pnotify_options.error.text=t.message,rg_pnotify.update(rg_pnotify_options.error))}})}(t,e)}}),jQuery(document).ready((function(){$.extend($.fn.dataTable.defaults,{autoWidth:!1,columnDefs:[{orderable:!1,width:"100px",targets:[5]}],dom:'<"datatable-scroll-wrap"t><"datatable-footer"ipr>',language:{search:"<span>Filter:</span> _INPUT_",searchPlaceholder:"Type to filter...",lengthMenu:"<span>Show:</span> _MENU_",paginate:{first:"First",last:"Last",next:"&rarr;",previous:"&larr;"}},drawCallback:function(){$(this).find("tbody tr").slice(-3).find(".dropdown, .btn-group").addClass("dropup")},preDrawCallback:function(){$(this).find("tbody tr").slice(-3).find(".dropdown, .btn-group").removeClass("dropup")}}),rg_banking.init()}))},5:function(t,e,a){t.exports=a("1ohs")}});