!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=27)}({27:function(e,t,a){e.exports=a("uygY")},uygY:function(e,t){var a,n,r,o,i,l,s,c;!function(e){e.fn.serializeObject=function(){var t=this,a={},n={},r={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,a){return e[t]=a,e},this.push_counter=function(e){return void 0===n[e]&&(n[e]=0),n[e]++},e.each(e(this).serializeArray(),(function(){if(r.validate.test(this.name)){for(var n,o=this.name.match(r.key),i=this.value,l=this.name;void 0!==(n=o.pop());)l=l.replace(new RegExp("\\["+n+"\\]$"),""),n.match(r.push)?i=t.build([],t.push_counter(l),i):n.match(r.fixed)?i=t.build([],n,i):n.match(r.named)&&(i=t.build({},n,i));a=e.extend(!0,a,i)}})),a}}(jQuery),rg_txn=(a=[],n={},r={},o=0,i="-NA-",l=function(e){e=void 0===e||e;var t=$("#items_field_rows tr");if(!1===e&&t.length>1)return t.each((function(e,t){if(0===e)return!0;var n=$(this),r=n.find(".rg_item_selector");r.select2({data:a,minimumInputLength:0,placeholder:"Choose item",tags:!0}),n.find(".rg_tax_selector").select2({allowClear:!0}),r.val(r.data("value")).trigger("change"),n.find(".item_row_description").keyup()})),!0;var n=t.length-1,r=$(".items_row_template").clone();r.removeClass("items_row_template hidden"),r.attr("id","row_"+n),r.find("[name^=items]").each((function(){var e=$(this).attr("name");$(this).attr("name",e.replace("_index_",n)),$(this).attr("data-row",n)})),r.appendTo("#items_field_rows"),r.find(".rg_item_selector").attr("data-row",n),r.find(".rg_tax_selector").attr("data-row",n),r.find(".item_row_delete").attr("data-row",n),r.find(".rg_item_selector").select2({data:a,minimumInputLength:0,placeholder:"Choose item",tags:!0}),r.find(".rg_item_selector").focus(),r.find(".rg_tax_selector").select2({allowClear:!0}),r.find(".rg_contact_selector").select2({allowClear:!0})},s=function(e){if(void 0===e)return console.log("not calling this function. row_id: "+e),!1;tax_id=0,void 0===r[e]&&(r[e]={taxable_amount:0}),tr=$("#row_"+e),debit=tr.find(".item_row_debit").val(),credit=tr.find(".item_row_credit").val(),contact_id=tr.find(".item_row_contact").val(),taxable_amount=rg_number(debit)+rg_number(credit),r[e]={contact_id:contact_id,type:null,type_id:0,name:"",description:tr.find(".item_row_description").val(),debit:rg_empty(debit)?0:debit,credit:rg_empty(credit)?0:credit},item=tr.find(".rg_item_selector").select2("data"),0===item.length?item={tax_inclusive:!1}:(item=item[0],r[e].type=item.type,r[e].type_id=isNaN(item.id)?0:item.id,r[e].name=item.text);var t=0,a=0;$.each(r,(function(e,n){t=rg_number(t)+rg_number(n.debit),a=rg_number(a)+rg_number(n.debit)})),$("#txn_subtotal").html(rg_number_format(t,2,".",",")),$("#txn_total").html(rg_number_format(a,2,".",",")),o=a,$("#txn_exchange_amount").html(rg_number_format(1*a,2,".",","))},c=function(){var e=$("#txn_form");window.location.pathname.split("/"),e.find(".select-search, .select").val("").trigger("change"),e.find("[name=internal_ref]").val(""),e.trigger("reset"),$("[id^=row_]").remove(),r=[],l(),l(),$("#rg-num-of-attahed-files").html(""),$("#rg-attahed-file-names").html(""),$("#dropzone_remove_all_files").html(""),$("#txn_totals").html(""),$("#txn_subtotal").html("0.00"),$("#txn_total").html("0.00"),$("div.btn-group").removeClass("open"),$("#txn_exchange_rate").hide()},{init:function(){var e,t,d;!function(){var e=$(".rg_item_selector");if(void 0===e.data("url"))return console.log("Will not get items. data-url: "+e.data("url")),!1;e.length&&$.ajax({url:e.data("url"),method:"POST",dataType:"json",success:function(e,t,n,r){a=e,$("#row_0 .rg_item_selector").select2({data:e,minimumInputLength:0,placeholder:"Choose item",tags:!0}).on("change",(function(){})),l(!1),"journal"===window.location.pathname.split("/")[2]&&l()}}),$(".select-results-color-danger").select2({containerCssClass:"bg-danger-400"})}(),(e=$("#txn_form")).on("change",".rg_item_selector",(function(){element=$(this),item={quantity:1,rate:0,id:0,discount:0,total:0},item.total=rg_number(item.rate)*rg_number(item.quantity),selected=$.extend({},element.select2("data")[0]),"undefined"==typeof selected&&(selected={rate:0,tax_id:0}),item.rate=selected.rate,item.total=rg_number(item.rate)*rg_number(item.quantity),$("#row_"+element.data("row")).find(".item_row_rate").val(item.rate),s(element.data("row"))})),e.on("keyup",".item_row_debit, .item_row_credit",(function(e){element=$(this),s(element.data("row"))})),e.on("change",".rg_tax_selector",(function(e){element=$(this),s(element.data("row"))})),$("#txn_form").on("click",".item_row_delete",(function(e){return element=$(this),row_id=element.data("row"),e.preventDefault(),e.stopPropagation(),$("#row_"+row_id).find(".item_row_rate").val(0),s(row_id),delete r[row_id],$("#row_"+row_id).find(".rg_item_selector, .rg_tax_selector").select2("destroy"),$("#row_"+row_id).remove(),console.log("Row #"+row_id+" deleted"),!0})),t="draft",Dropzone.options.rgDropzone={autoProcessQueue:!1,addRemoveLinks:!0,uploadMultiple:!0,parallelUploads:5,paramName:"file",maxFiles:5,maxFilesize:5,dictDefaultMessage:"Drop files to upload <span>or CLICK</span>",clickable:"#rg-txn-attache-files, #rg-dropzone",createImageThumbnails:!1,init:function(){for(var e=document.querySelectorAll(".submit_txn_form"),a=this,l=$("#txn_form"),s=$("#rg-num-of-attahed-files"),d=$("#rg-attahed-file-names"),u=$("#dropzone_remove_all_files"),m=null,f=0;f<e.length;f++)e[f].addEventListener("click",(function(e){if(m=$(this).data("onsuccess"),e.preventDefault(),e.stopPropagation(),a.processQueue(),0===a.getUploadingFiles().length){PNotify.removeAll();var t=new PNotify({text:"Please wait as perform some magic...",addclass:"bg-primary",type:"info",icon:"icon-spinner4 spinner",hide:!1,buttons:{closer:!0,sticker:!1},opacity:.9,width:"350px"}),s={buttons:{closer:!0,sticker:!0},width:"350px"};data=l.serializeObject(),data.items=$.extend({},r),data.taxes=$.extend({},n),data.total=o,data.onsuccess=m,$.ajax({url:l.attr("action"),method:l.attr("method"),data:data,dataType:"json",success:function(e,a,n,r){!0===e.status?(s.title="Done!",s.text=e.message,s.addclass="bg-success",s.type="success",s.icon="icon-checkmark3",s.opacity=1,s.width=PNotify.prototype.options.width,t.update(s),"view"===data.on_submit?window.location.href="/invoices/view/"+e.txn.id:"draft"===data.on_submit||data.on_submit,i=e.number,c()):(s.title="Error(s)!",s.text=e.message,s.addclass="bg-danger",s.type="danger",s.icon="icon-alert",t.update(s))}})}}));u.click((function(e){e.preventDefault(),e.stopPropagation(),a.removeAllFiles(),s.html(""),d.html(""),u.hide()})),a.on("addedfile",(function(e){setTimeout((function(){get_accepted_files=a.getAcceptedFiles().length,s.html(get_accepted_files+" file(s) attached."),d.append("<br>"+e.name),u.show()}),10)})),a.on("sending",(function(e,t,a){PNotify.removeAll(),new PNotify({text:"Please wait as perform some magic xxx...",addclass:"bg-primary",type:"info",icon:"icon-spinner4 spinner",hide:!1,buttons:{closer:!0,sticker:!1},opacity:.9,width:"350px"}),$.each(l.serializeObject(),(function(e,t){"items"!=e&&a.append(e,JSON.stringify(t))})),a.append("items",JSON.stringify(r)),a.append("taxes",JSON.stringify(n)),a.append("total",JSON.stringify(o)),a.append("onsuccess",m)})),a.on("processing",(function(e){a.options.url=l.attr("action")})),a.on("success",(function(e,n){a.removeFile(e),n=JSON.parse(n),PNotify.removeAll();var r=new PNotify({text:"Please wait as perform some magic xxx...",addclass:"bg-primary",type:"info",icon:"icon-spinner4 spinner",hide:!1,buttons:{closer:!0,sticker:!1},opacity:.9,width:"350px"}),o={buttons:{closer:!0,sticker:!0},width:"350px"};!0===n.status?(o.title="Done!",o.text=n.message,o.addclass="bg-success",o.type="success",o.icon="icon-checkmark3",o.opacity=1,o.width=PNotify.prototype.options.width,r.update(o),"view"===t.on_submit?window.location.href="/invoices/view/"+n.txn.id:"draft"===t.on_submit||t.on_submit,i=n.number,c()):(o.title="Error(s)!",o.text=n.message,o.addclass="bg-danger",o.type="danger",o.icon="icon-alert",r.update(o))}))}};try{$(".rg_datatable_sidebar").DataTable({columnDefs:[{targets:0,orderable:!1,checkboxes:{selectRow:!0,selectCallback:function(e,t,a){e.column(0).checkboxes.selected().length>0?$(".rg_datatable_onselect_btns").slideDown(100):$(".rg_datatable_onselect_btns").slideUp(100)}}},{targets:[0],orderable:!1}],select:{style:"multi",selector:"td:first-child"},order:[[0,!1]],ordering:!1,info:!1,bLengthChange:!1,bFilter:!1,iDisplayLength:20,aoColumns:[{mDataProp:"id"},{mDataProp:"number",sClass:"pl-5"},{mDataProp:"total",sClass:""}],fnRowCallback:function(e,t,a,n){var r='<h6 class="no-margin"><small class="display-block text-muted"><a href="/transaction/journals/'+t.id+'">View</a> | Date: '+t.date+"</small></h6>",o='<h6 class="no-margin text-right"><small>'+t.quote_currency+"</small> "+rg_number_format(t.total)+"</h6>";$("td:eq(1)",e).html(r),$("td:eq(2)",e).html(o)}})}catch(e){console.log(e)}try{d=$(".rg-datatable-txns-table").DataTable({buttons:{dom:{button:{className:"btn btn-default"}},buttons:[{extend:"copyHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-copy3"></i>'},{extend:"excelHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-file-excel"></i>'},{extend:"pdfHtml5",className:"btn btn-default btn-icon",text:'<i class="icon-file-pdf"></i>'}]},pagingType:"simple",language:{paginate:{next:"Next &rarr;",previous:"&larr; Prev"}},iDisplayLength:20,aLengthMenu:[[10,20,50,100],[10,20,50,100]],columnDefs:[{targets:0,orderable:!1,checkboxes:{selectRow:!0,selectCallback:function(e,t,a){e.column(0).checkboxes.selected().length>0?$(".rg_datatable_onselect_btns").slideDown(100):$(".rg_datatable_onselect_btns").slideUp(100)}}},{targets:[0,4],orderable:!1}],select:{style:"multi",selector:"td:first-child"},order:[[0,!1]],ordering:!1,aoColumns:[{mDataProp:"id"},{mDataProp:null,sClass:"text-left no-padding-left"},{mDataProp:"date",sClass:""},{mDataProp:"reference",sClass:""},{mDataProp:"total",sClass:"text-right"},{mDataProp:null,sClass:"text-left"}],fnRowCallback:function(e,t,a,n){var r='<ul class="icons-list">                    <li><a href="/transaction/journals/'+t.id+'"><i class="icon-pencil7"></i></a></li>                 </ul>';$("td:eq(1)",e).html(r),$("td:eq(4)",e).html(rg_number_format(t.total)+" "+t.base_currency),$("td:eq(5)",e).html("")}}),$("body").on("click",".rg_datatable_selected_delete, .rg_datatable_row_delete",(function(e){e.stopPropagation(),e.preventDefault();var t=[],a=rg_empty($(this).data("url"))?$(this).attr("href"):$(this).data("url"),n=d.column(0).checkboxes.selected();$.each(n,(function(e,a){t[e]=a})),swal({title:"Are you sure?",text:"You will not be able to recover the record(s)!",type:"warning",showCancelButton:!0,confirmButtonColor:"#EF5350",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel pls!",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},(function(e){e&&$.ajax({url:a,method:"POST",data:{ids:t},dataType:"json",success:function(e,t,a,n){!0===e.status?(swal({title:"Deleted!",text:e.message,confirmButtonColor:"#66BB6A",type:"success",timer:2e3}),d.ajax.reload(),$(".rg_datatable_onselect_btns").slideUp(100)):swal({title:"Failed!",text:e.message,confirmButtonColor:"#66BB6A",type:"danger",timer:2e3})}})}))}))}catch(e){console.log(e)}},new_item:function(){l()},form_reset:function(){var e;e=$("#txn_form"),$.each(r,(function(e,t){$("#row_"+e).find(".item_row_rate").val(0),s(e),delete r[e],$("#row_"+e).find(".rg_item_selector, .rg_tax_selector").select2("destroy"),$("#row_"+e).remove()})),e[0].reset(),"-NA-"!=i&&e.find("[name=number]").val(i),$("[name=contact_id]").val("").trigger("change")}}),jQuery(document).ready((function(){$.extend($.fn.dataTable.defaults,{autoWidth:!1,columnDefs:[{orderable:!1,width:"100px",targets:[5]}],dom:'<"datatable-header"fl><"datatable-scroll-wrap"t><"datatable-footer"ip>',language:{search:"<span>Filter:</span> _INPUT_",searchPlaceholder:"Type to filter...",lengthMenu:"<span>Show:</span> _MENU_",paginate:{first:"First",last:"Last",next:"&rarr;",previous:"&larr;"}},drawCallback:function(){$(this).find("tbody tr").slice(-3).find(".dropdown, .btn-group").addClass("dropup")},preDrawCallback:function(){$(this).find("tbody tr").slice(-3).find(".dropdown, .btn-group").removeClass("dropup")}}),rg_txn.init()}))}});